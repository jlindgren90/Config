#!/bin/bash

for THEME in colibre tango ; do
    mkdir -p ${THEME}
    cd ${THEME}
    unzip /usr/lib/libreoffice/share/config/images_${THEME}.zip

    DEST="${HOME}/.config/libreoffice/4/cache/${THEME}/150"

    for file in $(find -name \*.png) ; do
        outfile="${DEST}/${file}"
        echo "Rendering ${file} to ${outfile}"
        mkdir -p "$(dirname "${outfile}")"
        convert "${file}" -filter lanczos -resize 150% "${outfile}"
    done

    if [[ ${THEME} = colibre ]] ; then
        for file in vcl/res/check*.png vcl/res/radio*.png ; do
            outfile="${DEST}/${file}"
            echo "Copying ${file} to ${outfile} unchanged"
            mkdir -p "$(dirname "${outfile}")"
            cp "${file}" "${outfile}"
        done
    fi

    while IFS= read -r line ; do
        vals=($line)
        file="${vals[1]}"
        outfile1="${DEST}/${file}"
        outfile2="${DEST}/${vals[0]}"
        echo "Hard-linking ${outfile1} to ${outfile2}"
        mkdir -p "$(dirname "${outfile2}")"
        cp -l "${outfile1}" "${outfile2}"
    done < links.txt

    cd ..
    rm -r ${THEME}
done
